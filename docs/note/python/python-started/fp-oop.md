---
tag:
  - ç¬”è®°
tags:
  - Python

recommend: 4
sticky: 9996

description:
---

# Python å­¦ä¹ ç¬”è®°ï¼ˆå››ï¼‰ - FPã€OOP ç¼–ç¨‹

## å‡½æ•°å¼ç¼–ç¨‹

å‡½æ•°å¼ç¼–ç¨‹çš„æ ¸å¿ƒæ€æƒ³: å¼ºè°ƒ â€œè®¡ç®—å°±æ˜¯å‡½æ•°çš„åº”ç”¨â€ ï¼Œ
æ•°æ®å’Œå‡½æ•°æ˜¯åˆ†ç¦»çš„ï¼Œç¨‹åºå°½é‡ä¸ä¾èµ–å¤–éƒ¨çŠ¶æ€ï¼ˆå³é¿å…å‰¯ä½œç”¨ï¼‰ã€‚

å‡½æ•°å¼ç¼–ç¨‹çš„æ ¸å¿ƒç‰¹å¾:

- çº¯å‡½æ•°: ç›¸åŒè¾“å…¥æ°¸è¿œè¿”å›ç›¸åŒè¾“å‡ºï¼Œä¸ä¾èµ–å¤–éƒ¨çŠ¶æ€ã€‚
- å‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘: å‡½æ•°å¯ä»¥èµ‹å€¼ç»™å˜é‡ã€ä½œä¸ºå‚æ•°ä¼ é€’ã€ä½œä¸ºè¿”å›å€¼è¿”å›ã€‚
- é«˜é˜¶å‡½æ•°: å¯ä»¥æ¥æ”¶å‡½æ•°ä½œä¸ºå‚æ•°æˆ–è¿”å›å‡½æ•°ã€‚
- ä¸å¯å˜æ€§: æ•°æ®å°½é‡ä¸å¯å˜ï¼Œé¿å…å‰¯ä½œç”¨ã€‚

ä¸‹é¢æˆ‘ä»¬æ¥é€æ­¥ç†è§£è¿™äº›æ¦‚å¿µï¼š

### çº¯å‡½æ•°

çº¯å‡½æ•°ç®€å•æ¥è¯´å°±æ˜¯ åŒæ ·è¾“å…¥è·å¾—åŒæ ·è¾“å‡ºï¼Œä¸è¯»å†™å…¨å±€å˜é‡ï¼Œä¸æ”¹å‚æ•°å¯¹è±¡ã€‚

::: code-group

```Python [pure_function.py]
# çº¯å‡½æ•° (æ— å‰¯ä½œç”¨)
def square(x):
    return x * x

print(square(4))  # 16
print(square(4))  # 16  -> ä¸€ç›´éƒ½æ˜¯ 16

# å¯¹æ¯”ä¸€ä¸ªéçº¯å‡½æ•°ï¼ˆæœ‰å‰¯ä½œç”¨ï¼‰ï¼š
count = 0

def add_and_log(x):
    global count
    count += 1        # ä¿®æ”¹äº†å¤–éƒ¨çŠ¶æ€
    return x + count

print(add_and_log(10))  # 11
print(add_and_log(10))  # 12 (ç»“æœå˜äº†ï¼Œä¾èµ–å¤–éƒ¨å˜é‡ count)

```

:::

æ‰€ä»¥ çº¯å‡½æ•°æ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„æ ¸å¿ƒç‰¹ç‚¹ï¼Œå®ƒå¸¦æ¥çš„å¥½å¤„æ˜¯
ç¨‹åºæ›´å¯é¢„æµ‹ã€æ›´å®¹æ˜“æµ‹è¯•ã€æ›´å®¹æ˜“å¹¶è¡Œè®¡ç®—ã€‚

### é«˜é˜¶å‡½æ•°

é«˜é˜¶å‡½æ•°ç®€å•æ¥è¯´å°±æ˜¯æ¥å—å‡½æ•°ä½œä¸ºå‚æ•°ï¼Œæˆ–è€…è¿”å›å‡½æ•°çš„å‡½æ•°ã€‚

::: code-group

```python [higher_functions.py]
# æ¥æ”¶å‡½æ•°ä½œä¸ºå‚æ•°
def apply(func, x):
    return func(x)

print(apply(lambda n: n * 2, 5))  # 10

# æŠŠå‡½æ•°ä½œä¸ºç»“æœå€¼è¿”å›
def make_adder(n):
    def adder(x):
        return x + n
    return adder

add5 = make_adder(5)
print(add5(10))  # 15
```

:::

::: tip å…³é”®å­— lambda è¡¨ç¤ºåŒ¿åå‡½æ•°

Python å¯¹åŒ¿åå‡½æ•°çš„æ”¯æŒæœ‰é™ï¼Œåªæœ‰ä¸€äº›ç®€å•çš„æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨åŒ¿åå‡½æ•°ã€‚
åŒ¿åå‡½æ•°åªèƒ½æœ‰ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œä¸ç”¨å†™ returnï¼Œè¿”å›å€¼å°±æ˜¯è¯¥è¡¨è¾¾å¼çš„ç»“æœã€‚

:::

åƒ Python å†…ç½®çš„ `map / filter / sorted` ç­‰å‡½æ•°éƒ½æ˜¯é«˜é˜¶å‡½æ•°ã€‚

### ä¸å¯å˜æ€§

åœ¨ç¼–ç¨‹é‡Œï¼Œä¸å¯å˜æ€§å°±æ˜¯ï¼š
æ•°æ®ä¸€æ—¦åˆ›å»ºï¼Œå°±ä¸èƒ½è¢«ä¿®æ”¹ã€‚

å¦‚æœä½ è¦â€œä¿®æ”¹â€ï¼Œå…¶å®ä¼šå¾—åˆ°ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯åœ¨åŸæ¥çš„å¯¹è±¡ä¸Šæ”¹ã€‚

::: code-group

```python [immutable.py]
# ä¸å¯å˜å¯¹è±¡ï¼ˆimmutableï¼‰

x = "hello"
y = x.upper()
print(x)  # hello  ï¼ˆåŸå­—ç¬¦ä¸²æ²¡å˜ï¼‰
print(y)  # HELLO  ï¼ˆè¿”å›äº†ä¸€ä¸ªæ–°å­—ç¬¦ä¸²ï¼‰

# å¯å˜å¯¹è±¡ï¼ˆmutableï¼‰
arr = [1, 2, 3]
arr.append(4)
print(arr)  # [1, 2, 3, 4]  ï¼ˆåŸå¯¹è±¡è¢«æ”¹äº†ï¼‰
```

:::

::: tip ğŸ“ Python æ•°æ®ç±»å‹çš„å¯å˜æ€§å¯¹ç…§è¡¨
| ç±»å‹ | ç¤ºä¾‹ | å¯å˜ | è¯´æ˜ |
|-------------|-----------------------|--------|------|
| `int` | `x = 10` | <img width="30px" /> âŒ | æ•°å­—ä¸€æ—¦åˆ›å»ºï¼Œå€¼ä¸èƒ½æ”¹ï¼Œåªèƒ½æ–°å»º |
| `float` | `y = 3.14` | âŒ | å’Œ `int` ä¸€æ · |
| `complex` | `z = 1+2` | âŒ | å¤æ•°ç±»å‹ |
| `bool` | `flag = True` | âŒ | `True` / `False` å›ºå®š |
| `str` | `s = "hello"` | âŒ | ä¿®æ”¹ä¼šç”Ÿæˆæ–°å­—ç¬¦ä¸² |
| `tuple` | `t = (1,2,3)` | âŒ | å…ƒç»„æœ¬èº«ä¸å¯å˜ï¼Œä½†å…ƒç´ è‹¥æ˜¯å¯å˜å¯¹è±¡ï¼Œå¯ä»¥å˜ |
| `frozenset` | `fs = frozenset([1,2])` | âŒ | é›†åˆçš„ä¸å¯å˜ç‰ˆæœ¬ï¼Œå¯åšå­—å…¸é”® |
| `bytes` | `b = b"abc"` | âŒ | äºŒè¿›åˆ¶ä¸å¯å˜åºåˆ— |
| `list` | `arr = [1,2,3]` | âœ… | å¯ä»¥å¢åˆ æ”¹æŸ¥ |
| `dict` | `d = {"a":1}` | âœ… | å¯ä»¥å¢åŠ /ä¿®æ”¹é”®å€¼å¯¹ |
| `set` | `s = {1,2,3}` | âœ… | å¯ä»¥æ·»åŠ /åˆ é™¤å…ƒç´  |
| `bytearray` | `ba = bytearray(b"abc")` | âœ… | äºŒè¿›åˆ¶å¯å˜åºåˆ— |
:::

### è£…é¥°å™¨

åœ¨ Python é‡Œï¼Œè£…é¥°å™¨ï¼ˆDecoratorï¼‰å°±æ˜¯ä¸€ç§é«˜é˜¶å‡½æ•°ã€‚
å®ƒæ¥æ”¶ä¸€ä¸ªå‡½æ•°ä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°å‡½æ•°ã€‚

å½“éœ€è¦åœ¨å‡½æ•°è°ƒç”¨å‰åå¢åŠ é€»è¾‘æ—¶ï¼Œ
åˆä¸å¸Œæœ›ä¿®æ”¹å‡½æ•°çš„å®šä¹‰ï¼Œå°±å¯ä»¥ç”¨è£…é¥°å™¨æ¥å®ç°ï¼Œ
è¿™ç§åœ¨ä»£ç è¿è¡ŒæœŸé—´åŠ¨æ€å¢åŠ åŠŸèƒ½çš„æ–¹å¼å°±æ˜¯ è£…é¥°å™¨ï¼ˆDecoratorï¼‰ã€‚

::: code-group

```python [decorator.py] {}
# log æ˜¯é«˜é˜¶å‡½æ•°ï¼ˆæ¥æ”¶å‡½æ•° â†’ è¿”å›å‡½æ•°ï¼‰
def log(func):
    def wrapper(*args, **kwargs):
        print("before")
        result = func(*args, **kwargs)
        print("after")
        return result

    return wrapper


# @ è¯­æ³•ç³–è®©æˆ‘ä»¬èƒ½ä¼˜é›…åœ°â€œåŒ…è£¹â€å‡½æ•°
@log  # ç­‰ä»·äº say_hi = log(say_hi)
def say_hi():
    print("hi")


say_hi()
# before
# hi
# after
```

:::

#### functools.wraps

è¯´åˆ°è£…é¥°å™¨ï¼Œå°±ä¸å¾—ä¸æåˆ° `functools.wraps` äº†ã€‚ åœ¨ Python ä¸­åˆ›å»ºä¸€ä¸ªè£…é¥°å™¨çš„å¸¸è§å†™æ³•æ˜¯:

::: code-group

```python [functools_wraps.py]
def my_decorator(func):
    def wrapper(*args, **kwargs):
        print("Before call")
        return func(*args, **kwargs)

    return wrapper


@my_decorator
def add(x, y):
    """Return the sum of x and y."""
    return x + y


print(add.__name__)  # wrapper
print(add.__doc__)  # None

```

:::

è¿™æ ·ä¼šå‡ºç°ä¸€ä¸ªé—®é¢˜ï¼š`wrapper` æ›¿ä»£äº†åŸæ¥çš„ `func`ï¼Œ
å¯¼è‡´åŸå‡½æ•°çš„ä¸€äº›å…ƒä¿¡æ¯ï¼ˆæ¯”å¦‚ nameã€docã€æ³¨é‡Šæ–‡æ¡£ç­‰ï¼‰ä¸¢å¤±ã€‚

è¿™åœ¨è°ƒè¯•ã€æ–‡æ¡£ç”Ÿæˆï¼ˆSphinxï¼‰ã€ä»¥åŠæŸäº›æ¡†æ¶ï¼ˆæ¯”å¦‚ Flaskï¼‰é‡Œä¼šå¼•å‘é—®é¢˜ã€‚

`functools.wraps` å®ƒçš„ä½œç”¨ æ˜¯ä¸€ä¸ªè£…é¥°å™¨å·¥å‚ï¼Œç”¨æ¥ç®€åŒ–ä¿®å¤ä¸Šé¢çš„é—®é¢˜ã€‚

å®ƒçš„å®ç°æœ¬è´¨ä¸Šæ˜¯è°ƒç”¨äº† `functools.update_wrapper`ï¼Œä¼šæŠŠåŸå‡½æ•°çš„ä¸€äº›å±æ€§å¤åˆ¶åˆ°è£…é¥°å™¨çš„ `wrapper` å‡½æ•°ä¸Š:

::: code-group

```python [functools_wraps.py] {}
import functools  # [!code focus] [!code ++]


def my_decorator(func):
    @functools.wraps(func)  # [!code focus] [!code ++]
    def wrapper(*args, **kwargs):
        print("Before call")
        return func(*args, **kwargs)

    return wrapper


@my_decorator
def add(x, y):
    """Return the sum of x and y."""
    return x + y


print(add.__name__)  # add [!code focus] [!code ++]
print(add.__doc__)  # Return the sum of x and y. [!code focus] [!code ++]

```

:::

ç®€å•æ¥è¯´
`@functools.wraps(func)` çš„ä½œç”¨å°±æ˜¯ï¼š
åœ¨å†™è£…é¥°å™¨æ—¶ï¼Œä¿è¯è¢«è£…é¥°å‡½æ•°çš„å…ƒä¿¡æ¯ä¸ä¼šä¸¢å¤±ã€‚

::: tip special attributes / special methods
åƒ `__name__ã€__doc__` è¿™ç§ å‰ååŒä¸‹åˆ’çº¿çš„å±æ€§/æ–¹æ³•ï¼Œåœ¨ Python é‡Œæœ‰ä¸€ä¸ªä¸“é—¨çš„åå­—,

- å®˜æ–¹å«æ³•ï¼š`special attributes / special methods`
- ä¿—ç§°ï¼š`dunderï¼ˆdouble underscore çš„ç¼©å†™ï¼‰(å¦‚ dunder nameã€dunder doc)`
- å¤§å®¶å¹³æ—¶ä¹Ÿä¼šå¬åˆ°ï¼šé­”æœ¯æ–¹æ³•/é­”æœ¯å˜é‡ã€‚åœ¨ Python ç¤¾åŒºé‡Œï¼Œå‰ååŒä¸‹åˆ’çº¿çš„ä¸œè¥¿é€šå¸¸éƒ½å« é­”æœ¯ (magic) / ç‰¹æ®Š (special) ã€‚

:::

### åå‡½æ•°

å‡½æ•°å¼ç¼–ç¨‹ä¸­ï¼Œåå‡½æ•°æŒ‡çš„æ˜¯ï¼š
æŠŠä¸€ä¸ªå¤šå‚æ•°å‡½æ•°çš„éƒ¨åˆ†å‚æ•°å›ºå®šä¸‹æ¥ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„å‡½æ•°ã€‚

Python çš„ functools æ¨¡å—è¿˜æä¾›äº†å¾ˆå¤šæœ‰ç”¨çš„åŠŸèƒ½ï¼Œ
å…¶ä¸­ä¸€ä¸ªå°±æ˜¯åå‡½æ•°ï¼ˆPartial functionï¼‰ã€‚
å®ƒè®©ä»£ç æ›´ç®€æ´ï¼Œé¿å…å†™é‡å¤çš„ lambdaã€‚æœ¬è´¨ä¸Šæ˜¯å‡½æ•°ç»„åˆçš„ä¸€ç§æŠ€å·§ã€‚

::: code-group

```python [partial.py] {9,10,18}
from functools import partial


def power(base, exponent):
    return base**exponent


# æˆ‘ä»¬çŸ¥é“é€šè¿‡è®¾å®šå‚æ•°çš„é»˜è®¤å€¼ï¼Œå¯ä»¥é™ä½å‡½æ•°è°ƒç”¨çš„éš¾åº¦
def power2(base, exponent=2):
    return power(base, exponent)


print(power2(5))  # 25
print(power2(10))  # 100

# åŒæ ·åå‡½æ•°ä¹Ÿå¯ä»¥åšåˆ° å®ƒç»™å‡½æ•°é¢„è®¾å¸¸ç”¨å‚æ•°ï¼Œå¾—åˆ°æ›´ä¸“ç”¨çš„å‡½æ•°ã€‚
# å›ºå®š exponent=2ï¼Œå¾—åˆ°ä¸€ä¸ªâ€œå¹³æ–¹å‡½æ•°â€
square = partial(power, exponent=2)

print(square(5))  # 25
print(square(10))  # 100


```

:::

æ‰€ä»¥ï¼šå½“å‡½æ•°çš„å‚æ•°ä¸ªæ•°å¤ªå¤šï¼Œéœ€è¦ç®€åŒ–æ—¶ï¼Œ
ä½¿ç”¨ `functools.partial` å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œ
è¿™ä¸ªæ–°å‡½æ•°å¯ä»¥å›ºå®šä½åŸå‡½æ•°çš„éƒ¨åˆ†å‚æ•°ï¼Œä»è€Œåœ¨è°ƒç”¨æ—¶æ›´ç®€å•ã€‚

## é¢å‘å¯¹è±¡ç¼–ç¨‹

é¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ ¸å¿ƒæ€æƒ³: å¼ºè°ƒ â€œæ•°æ®å’Œæ“ä½œæ•°æ®çš„è¡Œä¸ºå°è£…åœ¨å¯¹è±¡ä¸­â€ï¼Œ
æŠŠæ•°æ®å’Œæ“ä½œå°è£…åœ¨å¯¹è±¡é‡Œï¼Œç”¨ç±»æ¥è¡¨è¾¾æ¦‚å¿µï¼Œç”¨ç»„åˆ/ç»§æ‰¿/å¤šæ€æ¥æ‰©å±•ã€‚

é¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ ¸å¿ƒç‰¹å¾:

- ç±»ä¸å¯¹è±¡: ç±»æ˜¯æ¨¡æ¿ï¼Œå¯¹è±¡æ˜¯å®ä¾‹ã€‚
- å°è£…: å¯¹è±¡çš„æ•°æ®å’Œæ–¹æ³•ç»‘å®šåœ¨ä¸€èµ·ï¼Œå†…éƒ¨å®ç°å¯¹å¤–éšè—ã€‚
- ç»§æ‰¿: å­ç±»ç»§æ‰¿çˆ¶ç±»å±æ€§å’Œæ–¹æ³•ï¼Œå®ç°ä»£ç å¤ç”¨ã€‚
- å¤šæ€: ä¸åŒå¯¹è±¡å¯ä»¥ç”¨ç›¸åŒæ¥å£è°ƒç”¨ä¸åŒå®ç°ã€‚

ä¸‹é¢æˆ‘ä»¬æ¥é€æ­¥ç†è§£è¿™äº›æ¦‚å¿µï¼š

### ç±»ä¸å®ä¾‹

é¢å‘å¯¹è±¡æœ€é‡è¦çš„æ¦‚å¿µå°±æ˜¯ç±»å’Œå®ä¾‹ï¼ˆå¯¹è±¡ï¼‰ã€‚è¿™é‡Œæˆ‘ä»¬å¿…é¡»è¦ç‰¢è®°:

"**ç±»æ˜¯å¯¹è±¡çš„æ¨¡æ¿/è“å›¾,å¯¹è±¡æ˜¯ç±»çš„å…·ä½“å®ä¾‹**"ã€‚
ç±»æ˜¯åˆ›å»ºå®ä¾‹çš„æ¨¡æ¿ï¼Œè€Œå®ä¾‹åˆ™æ˜¯ä¸€ä¸ªä¸€ä¸ªå…·ä½“çš„å¯¹è±¡ï¼Œ
å„ä¸ªå®ä¾‹æ‹¥æœ‰çš„æ•°æ®éƒ½äº’ç›¸ç‹¬ç«‹ï¼Œäº’ä¸å½±å“ã€‚

::: code-group

```python [class.py] {}
# å®šä¹‰ç±»ä½¿ç”¨ class å…³é”®å­—
class Person(object):
    def __init__(self, name, age):  # æ„é€ æ–¹æ³•ï¼ˆåˆå§‹åŒ–ï¼‰
        self.name = name
        self.age = age


# é€šè¿‡ç±»åˆ›å»ºç±»çš„å®ä¾‹
p1 = Person("Alice", 20)
p2 = Person("Bob", 25)

```

:::

::: tip \_\_init\_\_
åœ¨åˆ›å»ºå®ä¾‹çš„æ—¶é€šè¿‡ä¸€ä¸ªç‰¹æ®Šçš„æ–¹æ³• `__init__` æ¥åˆå§‹åŒ–å®ä¾‹çš„æ•°æ®æˆå‘˜ã€‚

`__init__` æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ°¸è¿œæ˜¯ `self`ï¼Œ
è¡¨ç¤ºåˆ›å»ºçš„å®ä¾‹æœ¬èº«ï¼Œå› æ­¤ï¼Œåœ¨ `__init__` æ–¹æ³•å†…éƒ¨ï¼Œ
å°±å¯ä»¥æŠŠå„ç§å±æ€§ç»‘å®šåˆ° `self`ã€‚

:::

### æ•°æ®å°è£…

åœ¨ç±»çš„å†…éƒ¨å®šä¹‰è®¿é—®æ•°æ®çš„å‡½æ•°ï¼Œè¿™æ ·å°±æŠŠæ•°æ®"å°è£…"èµ·æ¥äº†ã€‚å¤–éƒ¨åªé€šè¿‡æ¥å£è®¿é—®ã€‚

è¿™äº›å°è£…æ•°æ®çš„å‡½æ•°æ˜¯å’Œç±»æœ¬èº«æ˜¯å…³è”èµ·æ¥çš„ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºç±»çš„æ–¹æ³•ã€‚
é€šè¿‡åœ¨å®ä¾‹ä¸Šè°ƒç”¨æ–¹æ³•ï¼Œæˆ‘ä»¬å°±ç›´æ¥æ“ä½œäº†å¯¹è±¡å†…éƒ¨çš„æ•°æ®ï¼Œ
å¹¶ä¸”æ— éœ€çŸ¥é“æ–¹æ³•å†…éƒ¨çš„å®ç°ç»†èŠ‚ã€‚

::: code-group

```python [class.py] {}
# å®šä¹‰ç±»ä½¿ç”¨ class å…³é”®å­—
class Person(object):
    def __init__(self, name, age):  # æ„é€ æ–¹æ³•ï¼ˆåˆå§‹åŒ–ï¼‰
        self.name = name
        self.age = age

    def say_hello(self):  # æ–¹æ³•
        print(f"Hi, I'm {self.name}, {self.age} years old.")

    def set_name(self, name):  # æ–¹æ³•
        self.name = name

    def get_name(self):  # æ–¹æ³•
        return self.name


# é€šè¿‡ç±»åˆ›å»ºç±»çš„å®ä¾‹
p1 = Person("Alice", 20)
p2 = Person("Bob", 25)

p1.say_hello()  # Hi, I'm Alice, 20 years old.
p2.say_hello()  # Hi, I'm Bob, 25 years old.

p1.set_name("xiaoming") #
print(p1.get_name())  # xiaoming

```

:::

::: warning æ¥å£è®¿é—®
åœ¨ OOP é‡Œï¼Œæ¥å£ä¸æ˜¯ç‰¹æŒ‡æŸç§è¯­æ³•ï¼Œè€Œæ˜¯æŒ‡ å¯¹å¤–æä¾›çš„æ–¹æ³•ã€‚
å¯¹å¤–åªæš´éœ²æœ‰é™çš„è®¿é—®æ–¹å¼ï¼ˆæ¥å£ï¼‰ï¼Œå¤–éƒ¨ä¸ç›´æ¥æ“ä½œå†…éƒ¨æ•°æ®ï¼Œ
è€Œæ˜¯é€šè¿‡è¿™äº›æ–¹å¼æ¥è®¿é—®æˆ–ä¿®æ”¹ã€‚
:::

::: tip
å’Œæ™®é€šçš„å‡½æ•°ç›¸æ¯”ï¼Œåœ¨ç±»ä¸­å®šä¹‰çš„å‡½æ•°åªæœ‰ä¸€ç‚¹ä¸åŒï¼Œ
å°±æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°æ°¸è¿œæ˜¯å®ä¾‹å˜é‡ selfï¼Œ
å¹¶ä¸”ï¼Œè°ƒç”¨æ—¶ï¼Œä¸ç”¨ä¼ é€’è¯¥å‚æ•°ã€‚
é™¤æ­¤ä¹‹å¤–ï¼Œç±»çš„æ–¹æ³•å’Œæ™®é€šå‡½æ•°æ²¡æœ‰ä»»ä½•åŒºåˆ«ã€‚
:::

### ç»§æ‰¿å’Œå¤šæ€

å½“æˆ‘ä»¬å®šä¹‰ä¸€ä¸ª `class` çš„æ—¶å€™ï¼Œå¯ä»¥ä»æŸä¸ªç°æœ‰çš„ `class` ç»§æ‰¿ï¼Œ
æ–°çš„ `class` ç§°ä¸ºå­ç±» `ï¼ˆSubclassï¼‰`ï¼Œ
è€Œè¢«ç»§æ‰¿çš„ `class` ç§°ä¸ºåŸºç±»ã€çˆ¶ç±»æˆ–è¶…ç±» `ï¼ˆBase classã€Super classï¼‰`ã€‚

å­ç±»ä¸ä½†å¯ä»¥ç»§æ‰¿çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•ï¼Œè¿˜å¯ä»¥æ‰©å±•æˆ–é‡å†™:

::: code-group

```python [inheritance.py] {}
# ä» Person ç±»ç»§æ‰¿
class Teacher(Person):
    def __init__(self, name, age, subject):  # æ„é€ æ–¹æ³•ï¼ˆåˆå§‹åŒ–ï¼‰
        super().__init__(name, age)  # è°ƒç”¨çˆ¶ç±»çš„æ„é€ æ–¹æ³•
        self.subject = subject

    def say_hello(self):  # æ–¹æ³•é‡å†™
        print(
            f"Hi, I'm {self.name}, {self.age} years old. I'm a teacher of {self.subject}."
        )

# ä» Person ç±»ç»§æ‰¿
class Student(Person):
    def __init__(self, name, age, major):  # æ„é€ æ–¹æ³•ï¼ˆåˆå§‹åŒ–ï¼‰
        super().__init__(name, age)  # è°ƒç”¨çˆ¶ç±»çš„æ„é€ æ–¹æ³•
        self.major = major

    def say_hello(self):  # æ–¹æ³•é‡å†™
        print(
            f"Hi, I'm {self.name}, {self.age} years old. I'm a student of {self.major}."
        )


tc = Teacher("Alice", 30, "Python")
tc.say_hello()  # è°ƒç”¨é‡å†™æ–¹æ³•
# Hi, I'm Alice, 30 years old. I'm a teacher of Python.

# ç»§æ‰¿çˆ¶ç±»çš„æ–¹æ³•
print(tc.get_name())  # Alice

st = Student("XiaoMing", 14, "web")
st.say_hello()  # è°ƒç”¨é‡å†™æ–¹æ³•
# Hi, I'm XiaoMing, 14 years old. I'm a student of web.

# ç»§æ‰¿çˆ¶ç±»çš„æ–¹æ³•
print(st.get_name())  # XiaoMing

```

:::

å¯ä»¥çœ‹åˆ°ç»§æ‰¿æœ€å¤§çš„å¥½å¤„æ˜¯å­ç±»è·å¾—äº†çˆ¶ç±»çš„å…¨éƒ¨åŠŸèƒ½ã€‚

å½“å­ç±»å’Œçˆ¶ç±»å­˜åœ¨äº†ç›¸åŒçš„æ–¹æ³•ï¼Œå­ç±»çš„æ–¹æ³•ä¼šè¦†ç›–çˆ¶ç±»çš„æ–¹æ³•ã€‚
è¿™æ ·ï¼Œæˆ‘ä»¬å°±è·å¾—äº†ç»§æ‰¿çš„å¦ä¸€ä¸ªå¥½å¤„ï¼š**å¤šæ€**ã€‚

å¤šæ€å³ï¼šå¤šç§å½¢æ€ã€‚åŒæ ·çš„æ–¹æ³•åï¼Œä¸åŒçš„å¯¹è±¡ï¼Œæ‰§è¡Œçš„ç»“æœä¸åŒï¼Œ
è¡¨ç°å‡ºçš„è¡Œä¸ºä¸åŒ:

::: code-group

```python [inheritance.py] {}
# æˆ‘ä»¬å†å®šä¹‰ä¸€ä¸ªä» Person æ´¾ç”Ÿçš„ Worker
class Worker(Person):
    def say_hello(self):  # æ–¹æ³•é‡å†™
        print(f"Hi, I'm {self.name}, {self.age} years old. I'm a worker.")


# å†æ¥å®šä¹‰ä¸€ä¸ªè°ƒç”¨è€…
def self_introduction(person: Person):
    person.say_hello()


tc = Teacher("Alice", 30, "Python")
st = Student("XiaoMing", 14, "web")
wk = Worker("xiaobai", 33)


self_introduction(tc)
# Hi, I'm Alice, 30 years old. I'm a teacher of Python.
self_introduction(st)
# Hi, I'm XiaoMing, 14 years old. I'm a student of web
self_introduction(wk)
# Hi, I'm xiaobai, 33 years old. I'm a worker.

```

:::

æ‰€ä»¥æˆ‘ä»¬å‘ç°ï¼Œæˆ‘ä»¬æ–°å¢ä¸€ä¸ªå­ç±» `Worker` åï¼Œå¹¶ä¸éœ€è¦å¯¹ `self_introduction` è¿›è¡Œä¿®æ”¹ã€‚
æˆ‘ä»¬åªéœ€è¦æ¥æ”¶ `Person` ç±»å‹å°±å¯ä»¥äº†ã€‚

`self_introduction` è°ƒç”¨åªç®¡è°ƒç”¨ï¼Œä¸ç®¡ç»†èŠ‚ï¼ŒåªçŸ¥é“å®ƒæœ‰å¯ä»¥è°ƒç”¨çš„ `say_hello` æ–¹æ³•ã€‚
è°ƒç”¨æ–¹å¼ä¸€æ ·ï¼Œä½†è¡Œä¸ºä¸åŒï¼Œè¿™å°±æ˜¯å¤šæ€çš„æœ¬è´¨ã€‚

::: tip è‘—åçš„â€œå¼€é—­â€åŸåˆ™
å¯¹æ‰©å±•å¼€æ”¾ï¼šå…è®¸æ–°å¢ Person å­ç±»ï¼›
å¯¹ä¿®æ”¹å°é—­ï¼šä¸éœ€è¦ä¿®æ”¹ä¾èµ– Person ç±»å‹çš„ self_introduction()ç­‰å‡½æ•°ã€‚
:::

#### ä¸ä¾èµ–ç»§æ‰¿çš„å¤šæ€ï¼ˆé¸­å­ç±»å‹ï¼‰

Python æ¯”è¾ƒç‰¹åˆ«ï¼Œå®ƒçš„å¤šæ€ä¸ä¸€å®šè¦é ç»§æ‰¿ã€‚
Python çš„å¤šæ€æ˜¯åŸºäºé¸­å­ç±»å‹çš„ï¼ˆduck typingï¼‰ï¼Œé¸­å­ç±»å‹æ˜¯æŒ‡ï¼šå¦‚æœçœ‹èµ·æ¥åƒé¸­å­ï¼Œé‚£å°±æ˜¯é¸­å­ã€‚

åªè¦å¯¹è±¡æœ‰ `say_hello` æ–¹æ³•ï¼Œå°±èƒ½è¢« `self_introduction` ä½¿ç”¨ï¼š

::: code-group

```python [polymorphism.py] {}
class Programmer:
    def __init__(self, name):
        self.name = name

    def say_hello(self):
        print(f"Hi, I'm {self.name}, I'm a programmer.")


prg = Programmer("xiaowang")
self_introduction(prg)
# Hi, I'm xiaowang, I'm a programmer


```

:::

å¯ä»¥çœ‹åˆ°è™½ç„¶ `Programmer` æ²¡æœ‰ç»§æ‰¿ `Person`
ä½†å®ƒä¹Ÿèƒ½ç”¨åœ¨ `self_introduction` é‡Œï¼Œå› ä¸ºå®ƒå®ç°äº† `say_hello`ã€‚

åœ¨ `Python` ä¸­ï¼Œå¤šæ€ç”šè‡³ä¸éœ€è¦ç»§æ‰¿ï¼Œåªè¦â€œæœ‰è¿™ä¸ªæ–¹æ³•â€å°±è¡Œã€‚

::: tip
åŠ¨æ€è¯­è¨€çš„é¸­å­ç±»å‹ç‰¹ç‚¹å†³å®šäº†ç»§æ‰¿ä¸åƒé™æ€è¯­è¨€é‚£æ ·æ˜¯å¿…é¡»çš„ã€‚

å¯¹äºé™æ€è¯­è¨€ï¼ˆä¾‹å¦‚ Javaï¼‰æ¥è¯´ï¼Œå¦‚æœéœ€è¦ä¼ å…¥ `Person` ç±»å‹ï¼Œ
åˆ™ä¼ å…¥çš„å¯¹è±¡å¿…é¡»æ˜¯ `Person` ç±»å‹æˆ–è€…å®ƒçš„å­ç±»ï¼Œå¦åˆ™ï¼Œå°†æ— æ³•è°ƒç”¨ `say_hello` æ–¹æ³•ã€‚

å¯¹äº Python è¿™æ ·çš„åŠ¨æ€è¯­è¨€æ¥è¯´ï¼Œåˆ™ä¸ä¸€å®šéœ€è¦ä¼ å…¥ `Person` ç±»å‹ã€‚
æˆ‘ä»¬åªéœ€è¦ä¿è¯ä¼ å…¥çš„å¯¹è±¡æœ‰ä¸€ä¸ª `say_hello` æ–¹æ³•å°±å¯ä»¥äº†
:::

## é¢å‘å¯¹è±¡é«˜çº§

æ•°æ®å°è£…ã€ç»§æ‰¿å’Œå¤šæ€åªæ˜¯é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ä¸­æœ€åŸºç¡€çš„ 3 ä¸ªæ¦‚å¿µã€‚åœ¨ Python ä¸­ï¼Œé¢å‘å¯¹è±¡è¿˜æœ‰å¾ˆå¤šé«˜çº§ç‰¹æ€§ï¼Œå…è®¸æˆ‘ä»¬å†™å‡ºéå¸¸å¼ºå¤§çš„åŠŸèƒ½ã€‚

### å®ä¾‹å±æ€§ã€ç±»å±æ€§

å½“ç»™å®ä¾‹ç»‘å®šå±æ€§çš„æ–¹æ³•æ—¶æ˜¯é€šè¿‡å®ä¾‹çš„å˜é‡ï¼Œæˆ–è€…é€šè¿‡ self å˜é‡æ¥ç»‘å®šã€‚
æˆ‘ä»¬è¿˜å¯ä»¥ç»™ç±»ç»‘å®š ç±»çš„å±æ€§:

::: code-group

```python [class.py] {}
class Person(object):
    person_total = 0  # [!code focus] [!code ++]

    def __init__(self, name, age):
        Person.person_total += 1  # ä¿®æ”¹ç±»å±æ€§ç»Ÿè®¡äººæ•°
        self.name = name


p1 = Person("A", 20)  # [!code focus] [!code ++]
p2 = Person("B", 20)  # [!code focus] [!code ++]
p3 = Person("C", 20)  # [!code focus] [!code ++]

print(Person.person_total)  # 3  è®¿é—®ç±»å±æ€§ [!code focus] [!code ++]
print(p2.person_total)  # 3 ç±»çš„æ‰€æœ‰å®ä¾‹éƒ½å¯ä»¥è®¿é—®  [!code focus] [!code ++]

```

:::

å®ä¾‹å±æ€§ã€ç±»å±æ€§:

- å®ä¾‹å±æ€§å±äºå„ä¸ªå®ä¾‹æ‰€æœ‰ï¼Œäº’ä¸å¹²æ‰°ã€‚
- ç±»å±æ€§å±äºç±»æ‰€æœ‰ï¼Œæ‰€æœ‰å®ä¾‹å…±äº«ä¸€ä¸ªå±æ€§ã€‚
- å®šä¹‰äº†ä¸€ä¸ªç±»å±æ€§åï¼Œè¿™ä¸ªå±æ€§è™½ç„¶å½’ç±»æ‰€æœ‰ï¼Œä½†ç±»çš„æ‰€æœ‰å®ä¾‹éƒ½å¯ä»¥è®¿é—®åˆ°ã€‚
- ä¸è¦å¯¹å®ä¾‹å±æ€§å’Œç±»å±æ€§ä½¿ç”¨ç›¸åŒçš„åå­—ã€‚

### ç±»å’Œå®ä¾‹çš„å±æ€§æ§åˆ¶

åœ¨æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå®ä¾‹åï¼Œ
æˆ‘ä»¬å¯ä»¥ç»™è¯¥å®ä¾‹ç»‘å®šä»»ä½•å±æ€§å’Œæ–¹æ³•ï¼Œ
è¿™å°±æ˜¯åŠ¨æ€è¯­è¨€çš„çµæ´»æ€§ã€‚

Python å…è®¸åœ¨å®šä¹‰ class çš„æ—¶å€™ï¼Œå®šä¹‰ä¸€ä¸ªç‰¹æ®Šçš„ `__slots__`å˜é‡ï¼Œ
æ¥é™åˆ¶è¯¥ class å®ä¾‹èƒ½æ·»åŠ çš„å±æ€§ï¼š

::: code-group

```python [] {}
# ç”¨tupleå®šä¹‰å…è®¸ç»‘å®šçš„å±æ€§åç§°
class Person:
    __slots__ = ("name", "age")  # åªèƒ½æœ‰è¿™ä¸¤ä¸ªå±æ€§


p = Person()
p.name = "Alice"  # âœ…
p.age = 20  # âœ…
# p.gender = "F"  # âŒ AttributeError
```

:::

éœ€è¦æ³¨æ„æ˜¯`__slots__`å®šä¹‰çš„å±æ€§ä»…å¯¹
å½“å‰ç±»å®ä¾‹èµ·ä½œç”¨ï¼Œå¯¹ç»§æ‰¿çš„å­ç±»æ˜¯ä¸èµ·ä½œç”¨çš„ã€‚

### å±æ€§ç®¡ç†(@property)

Python é¢å‘å¯¹è±¡é‡Œçš„ä¸€ä¸ª é«˜çº§ç‰¹æ€§ `@property`,
å®ƒçš„æœ¬è´¨å°±æ˜¯ é€šè¿‡è£…é¥°å™¨æŠŠæ–¹æ³•ä¼ªè£…æˆå±æ€§æ¥è®¿é—®ã€‚

å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªçŸ©å½¢ç±»ï¼Œæ¥è®¡ç®—çŸ©å½¢çš„é¢ç§¯å’Œå‘¨é•¿ï¼š

::: code-group

```python [rectangle.py] {}
class Rectangle:
    @property
    def width(self):
        return self._width

    @width.setter  # å¯è¯»å¯å†™å±æ€§
    def width(self, value):
        self._width = value

    @property
    def height(self):
        return self._height

    @height.setter  # å¯è¯»å¯å†™å±æ€§
    def height(self, value):
        self._height = value

    @property  # åªè¯»å±æ€§
    def area(self):
        return self._width * self._height


r = Rectangle()
r.width = 10
r.height = 5
# r.area = 50 # x âŒ AttributeError

print(r.width)  # âœ… 10 ç›´æ¥åƒå±æ€§ä¸€æ ·è®¿é—®ï¼Œä¸ç”¨åŠ  ()
print(r.height)  # âœ… 5 ç›´æ¥åƒå±æ€§ä¸€æ ·è®¿é—®ï¼Œä¸ç”¨åŠ  ()
print(r.area)  # âœ… 50 ç›´æ¥åƒå±æ€§ä¸€æ ·è®¿é—®ï¼Œä¸ç”¨åŠ  ()

```

:::

- å½“ä½¿ç”¨ `@property` æ—¶ï¼Œå®ƒåˆåˆ›å»ºäº†å¦ä¸€ä¸ªè£…é¥°å™¨ `@score.setter`ã€‚
- å½“æˆ‘ä»¬åªå†™ `@property` æ—¶ï¼Œæ²¡æœ‰å†™ `setter`ï¼Œé‚£å®ƒå°±æ˜¯åªè¯»å±æ€§ã€‚
- è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ å±æ€§çš„æ–¹æ³•åä¸è¦å’Œå®ä¾‹å˜é‡é‡åã€‚

## FP ä¸ OOP

|      | å‡½æ•°å¼ç¼–ç¨‹                  | é¢å‘å¯¹è±¡ç¼–ç¨‹                     |
| ---- | --------------------------- | -------------------------------- |
| æ€æƒ³ | å‡½æ•°å’Œè¡Œä¸ºåˆ†ç¦» å‡½æ•°å¼æ˜¯æ ¸å¿ƒ | æ•°æ®å’Œæ“ä½œæ•°æ®çš„è¡Œä¸ºå°è£…åœ¨å¯¹è±¡ä¸­ |
| çŠ¶æ€ | è¦å°½é‡æ— çŠ¶æ€ ä¸ä¿®æ”¹å¤–éƒ¨å˜é‡ | å¯¹è±¡æœ‰çŠ¶æ€æœ‰æ–¹æ³•å¯ä»¥ä¿®æ”¹å¯¹è±¡     |
| æ ¸å¿ƒ | å‡½æ•°ã€é«˜é˜¶å‡½æ•°ã€ä¸å¯å˜æ•°æ®  | ç±»ã€å¯¹è±¡ã€ç»§æ‰¿ã€å¤šæ€             |
| ä¼˜åŠ¿ | å¹¶è¡Œã€å®‰å…¨ã€é€»è¾‘æ¸…æ™°        | ç»„ç»‡å¤æ‚çš„ç³»ç»Ÿ                   |
| åœºæ™¯ | æ•°æ®å¤„ç†ã€è®¡ç®—æµæ°´çº¿        | å¤§å‹ç³»ç»Ÿã€æ¨¡æ‹Ÿå®ä½“ã€GUI          |
